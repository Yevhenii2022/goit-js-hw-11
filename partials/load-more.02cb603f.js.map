{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,0BAKA,MAAMC,EAASC,SAASC,eAAe,eACjCC,EAAYF,SAASG,cAAc,YACnCC,EAAgBJ,SAASG,cAAc,cAEvCE,EAAY,IAAI,EAAAC,EAAAC,WAEhBC,EAAW,IAAIC,EAAAC,GAAJ,CAAmB,aAAc,CAChDC,aAAc,MACdC,aAAc,QAsEhB,SAASC,EAAkBC,GACzB,MAAMC,EAASD,EACZE,KACC,EAACC,aACCA,EAAYC,cACZA,EAAaC,KACbA,EAAIC,MACJA,EAAKC,MACLA,EAAKC,SACLA,EAAQC,UACRA,KAEA,uEACoCL,gGAEID,WAAsBE,4MAKzBC,kKAIAC,qKAIAC,sKAIAC,6EAMxCC,KAAK,IAERtB,EAAUuB,mBAAmB,YAAaV,GAE1CP,EAASkB,S,CAGX,SAASC,EAAkBC,GACzBxB,EAAcyB,MAAMC,QAAUF,EAAU,QAAU,M,CAYpD,SAASG,IACPtB,EAAAZ,GAASmC,OAAOC,KACd,6DACA,CACEC,SAAU,iB,CAWhB,SAASC,EAAiBC,GACxB3B,EAAAZ,GAASmC,OAAOK,QACd,+DAA+DD,EAAME,WACrE,CACEJ,SAAU,iB,CAhJhBP,GAAkB,GAElB5B,EAAOwC,iBAAiB,UAGxBC,eAAkCC,GAWhC,GAVAA,EAAMC,iBAENf,GAAkB,GAElBzB,EAAUyC,UAAY,GAEtBtC,EAAUuC,KAAO,EAEjBvC,EAAUwC,MAAQJ,EAAMK,cAAcC,SAASC,YAAYC,MAAMC,OAEzC,KAApB7C,EAAUwC,MAEZ,YAoIFpC,EAAAZ,GAASmC,OAAOC,KACd,uEACA,CACEC,SAAU,kBApId,IACE,MAAQiB,KAAMC,EAAQC,UAAWC,SACzBjD,EAAUkD,YAElB,IAAKD,EAEH,YA0FJ7C,EAAAZ,GAASmC,OAAOK,QACd,2EACA,CACEH,SAAU,kBAtFZ,GAoGsBmB,EAxGLC,EAyGnB7C,EAAAZ,GAASmC,OAAOwB,QAAQ,oBAAoBH,YAAqB,CAC/DnB,SAAU,kBAxGVrB,EAAkBuC,GAEdE,EAAgBjD,EAAUuC,KAAOvC,EAAUoD,SAG7C,OAFA9B,GAAkB,QAClBI,IAIFJ,GAAkB,E,CAClB,MAAOS,GACPsB,QAAQC,IAAIvB,GACZD,EAAiBC,E,CA2FrB,IAA0BiB,C,IAnI1BjD,EAAcmC,iBAAiB,SA4C/BC,eAAwCC,GACtCpC,EAAUuC,MAAQ,EAElB,IACE,MAAQO,KAAMC,EAAQC,UAAWC,SACzBjD,EAAUkD,YAElB1C,EAAkBuC,GAwGtB,WACE,MAAQQ,OAAQC,GACd3D,EAAU4D,kBAAkBC,wBAE9BC,OAAOC,SAAS,CACdC,IAAkB,EAAbL,EACLM,SAAU,U,CA5GVC,GAEId,EAAgBjD,EAAUuC,KAAOvC,EAAUoD,WAC7C9B,GAAkB,GAClBI,I,CAEF,MAAOK,GACPD,EAAiBC,E","sources":["src/js/load-more.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { ImagesAPI } from './fetch-images';\n\nconst formEl = document.getElementById('search-form');\nconst galleryEl = document.querySelector('.gallery');\nconst loadMoreBtnEl = document.querySelector('.load-more');\n\nconst imagesAPI = new ImagesAPI();\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: '250',\n});\n\nisLoadMoreBtnShow(false);\n\nformEl.addEventListener('submit', handleFormElSubmit);\nloadMoreBtnEl.addEventListener('click', handleLoadMoreBtnElClick);\n\nasync function handleFormElSubmit(event) {\n  event.preventDefault();\n\n  isLoadMoreBtnShow(false);\n\n  galleryEl.innerHTML = '';\n\n  imagesAPI.page = 1;\n\n  imagesAPI.query = event.currentTarget.elements.searchQuery.value.trim();\n\n  if (imagesAPI.query === '') {\n    notifySearchNameAbsence();\n    return;\n  }\n\n  try {\n    const { hits: images, totalHits: totalQuantity } =\n      await imagesAPI.getImages();\n\n    if (!totalQuantity) {\n      notifyIncorrectQuery();\n      return;\n    }\n\n    showAmountOfHits(totalQuantity);\n\n    renderGalleryList(images);\n\n    if (totalQuantity < imagesAPI.page * imagesAPI.per_page) {\n      isLoadMoreBtnShow(false);\n      notifyEndOfGallery();\n      return;\n    }\n\n    isLoadMoreBtnShow(true);\n  } catch (error) {\n    console.log(error);\n    notifyQueryError(error);\n  }\n}\n\nasync function handleLoadMoreBtnElClick(event) {\n  imagesAPI.page += 1;\n\n  try {\n    const { hits: images, totalHits: totalQuantity } =\n      await imagesAPI.getImages();\n\n    renderGalleryList(images);\n\n    autoScrollPage();\n\n    if (totalQuantity < imagesAPI.page * imagesAPI.per_page) {\n      isLoadMoreBtnShow(false);\n      notifyEndOfGallery();\n    }\n  } catch (error) {\n    notifyQueryError(error);\n  }\n}\n\nfunction renderGalleryList(gallerys) {\n  const markup = gallerys\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<div class=\"photo-card\">\n        <a class=\"photo-card__item\" href=\"${largeImageURL}\">\n          <div class=\"photo-card__tumb\">\n            <img class=\"photo-card__img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n          </div>\n          <div class=\"info\">\n            <p class=\"info-item\">\n              <b class=\"info-item__param\">Likes</b>\n              <span class=\"info-item__num\">${likes}</span>\n            </p>\n            <p class=\"info-item\">\n              <b class=\"info-item__param\">Views</b>\n              <span class=\"info-item__num\">${views}</span>\n            </p>\n            <p class=\"info-item\">\n              <b class=\"info-item__param\">Comments</b>\n              <span class=\"info-item__num\">${comments}</span>\n            </p>\n            <p class=\"info-item\">\n              <b class=\"info-item__param\">Downloads</b>\n              <span class=\"info-item__num\">${downloads}</span>\n            </p>\n          </div>\n        </a>\n      </div>`\n    )\n    .join('');\n\n  galleryEl.insertAdjacentHTML('beforeend', markup);\n\n  lightbox.refresh();\n}\n\nfunction isLoadMoreBtnShow(boolean) {\n  loadMoreBtnEl.style.display = boolean ? 'block' : 'none';\n}\n\nfunction notifyIncorrectQuery() {\n  Notiflix.Notify.failure(\n    'Sorry, there are no images matching your search query. Please try again.',\n    {\n      position: 'center-center',\n    }\n  );\n}\n\nfunction notifyEndOfGallery() {\n  Notiflix.Notify.info(\n    \"We're sorry, but you've reached the end of search results.\",\n    {\n      position: 'center-center',\n    }\n  );\n}\n\nfunction showAmountOfHits(totalHits) {\n  Notiflix.Notify.success(`Hooray! We found ${totalHits} images.`, {\n    position: 'center-center',\n  });\n}\n\nfunction notifyQueryError(error) {\n  Notiflix.Notify.failure(\n    `Oops! Something went wrong. You caught the following error: ${error.message}.`,\n    {\n      position: 'center-center',\n    }\n  );\n}\n\nfunction notifySearchNameAbsence() {\n  Notiflix.Notify.info(\n    'To search for pictures you need to specify what you are looking for.',\n    {\n      position: 'center-center',\n    }\n  );\n}\n\nfunction autoScrollPage() {\n  const { height: cardHeight } =\n    galleryEl.firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["$7Y9D8","parcelRequire","$e13b538bfdccfbd0$var$formEl","document","getElementById","$e13b538bfdccfbd0$var$galleryEl","querySelector","$e13b538bfdccfbd0$var$loadMoreBtnEl","$e13b538bfdccfbd0$var$imagesAPI","$18XA8","ImagesAPI","$e13b538bfdccfbd0$var$lightbox","$parcel$interopDefault","$fZKcF","captionsData","captionDelay","$e13b538bfdccfbd0$var$renderGalleryList","gallerys","markup","map","webformatURL","largeImageURL","tags","likes","views","comments","downloads","join","insertAdjacentHTML","refresh","$e13b538bfdccfbd0$var$isLoadMoreBtnShow","boolean","style","display","$e13b538bfdccfbd0$var$notifyEndOfGallery","Notify","info","position","$e13b538bfdccfbd0$var$notifyQueryError","error","failure","message","addEventListener","async","event","preventDefault","innerHTML","page","query","currentTarget","elements","searchQuery","value","trim","hits","images","totalHits","totalQuantity","getImages","success","per_page","console","log","height","cardHeight","firstElementChild","getBoundingClientRect","window","scrollBy","top","behavior","$e13b538bfdccfbd0$var$autoScrollPage"],"version":3,"file":"load-more.02cb603f.js.map"}